angular.module("ui-notification",[]),angular.module("ui-notification").provider("Notification",function(){this.options={delay:5e3,startTop:10,startRight:10,verticalSpacing:10,horizontalSpacing:10,positionX:"right",positionY:"top",replaceMessage:!1,templateUrl:"angular-ui-notification.html",onClose:void 0,closeOnClick:!0,maxCount:0,container:"body"},this.setOptions=function(options){if(!angular.isObject(options))throw new Error("Options should be an object!");this.options=angular.extend({},this.options,options)},this.$get=["$timeout","$http","$compile","$templateCache","$rootScope","$injector","$sce","$q","$window",function($timeout,$http,$compile,$templateCache,$rootScope,$injector,$sce,$q,$window){var options=this.options,startTop=options.startTop,startRight=options.startRight,verticalSpacing=options.verticalSpacing,horizontalSpacing=options.horizontalSpacing,delay=options.delay,messageElements=[],isResizeBound=!1,notify=function(args,t){function processNotificationTemplate(template){function setCssTransitions(value){["-webkit-transition","-o-transition","transition"].forEach(function(prefix){templateElement.css(prefix,value)})}var scope=args.scope.$new();scope.message=$sce.trustAsHtml(args.message),scope.title=$sce.trustAsHtml(args.title),scope.t=args.type.substr(0,1),scope.delay=args.delay,scope.onClose=args.onClose;var reposite=function(){for(var j=0,k=0,lastTop=startTop,lastRight=startRight,lastPosition=[],i=messageElements.length-1;i>=0;i--){var element=messageElements[i];if(args.replaceMessage&&i<messageElements.length-1)element.addClass("killed");else{var elHeight=parseInt(element[0].offsetHeight),elWidth=parseInt(element[0].offsetWidth),position=lastPosition[element._positionY+element._positionX];top+elHeight>window.innerHeight&&(position=startTop,k++,j=0);var top=lastTop=position?0===j?position:position+verticalSpacing:startTop,right=lastRight+k*(horizontalSpacing+elWidth);element.css(element._positionY,top+"px"),"center"==element._positionX?element.css("left",parseInt(window.innerWidth/2-elWidth/2)+"px"):element.css(element._positionX,right+"px"),lastPosition[element._positionY+element._positionX]=top+elHeight,options.maxCount>0&&messageElements.length>options.maxCount&&0===i&&element.scope().kill(!0),j++}}},templateElement=$compile(template)(scope);templateElement._positionY=args.positionY,templateElement._positionX=args.positionX,templateElement.addClass(args.type);var closeEvent=function(e){e=e.originalEvent||e,("click"===e.type||"opacity"===e.propertyName&&e.elapsedTime>=1)&&(scope.onClose&&scope.$apply(scope.onClose(templateElement)),templateElement.remove(),messageElements.splice(messageElements.indexOf(templateElement),1),scope.$destroy(),reposite())};args.closeOnClick&&(templateElement.addClass("clickable"),templateElement.bind("click",closeEvent)),templateElement.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",closeEvent),angular.isNumber(args.delay)&&$timeout(function(){templateElement.addClass("killed")},args.delay),setCssTransitions("none"),angular.element(document.querySelector(args.container)).append(templateElement);var offset=-(parseInt(templateElement[0].offsetHeight)+50);if(templateElement.css(templateElement._positionY,offset+"px"),messageElements.push(templateElement),"center"==args.positionX){var elWidth=parseInt(templateElement[0].offsetWidth);templateElement.css("left",parseInt(window.innerWidth/2-elWidth/2)+"px")}$timeout(function(){setCssTransitions("")}),scope._templateElement=templateElement,scope.kill=function(isHard){isHard?(scope.onClose&&scope.$apply(scope.onClose(scope._templateElement)),messageElements.splice(messageElements.indexOf(scope._templateElement),1),scope._templateElement.remove(),scope.$destroy(),$timeout(reposite)):scope._templateElement.addClass("killed")},$timeout(reposite),isResizeBound||(angular.element($window).bind("resize",function(e){$timeout(reposite)}),isResizeBound=!0),deferred.resolve(scope)}var deferred=$q.defer();"object"==typeof args&&null!==args||(args={message:args}),args.scope=args.scope?args.scope:$rootScope,args.template=args.templateUrl?args.templateUrl:options.templateUrl,args.delay=angular.isUndefined(args.delay)?delay:args.delay,args.type=t||args.type||options.type||"",args.positionY=args.positionY?args.positionY:options.positionY,args.positionX=args.positionX?args.positionX:options.positionX,args.replaceMessage=args.replaceMessage?args.replaceMessage:options.replaceMessage,args.onClose=args.onClose?args.onClose:options.onClose,args.closeOnClick=null!==args.closeOnClick&&void 0!==args.closeOnClick?args.closeOnClick:options.closeOnClick,args.container=args.container?args.container:options.container;var template=$templateCache.get(args.template);return template?processNotificationTemplate(template):$http.get(args.template,{cache:!0}).then(processNotificationTemplate).catch(function(data){throw new Error("Template ("+args.template+") could not be loaded. "+data)}),deferred.promise};return notify.primary=function(args){return this(args,"primary")},notify.error=function(args){return this(args,"error")},notify.success=function(args){return this(args,"success")},notify.info=function(args){return this(args,"info")},notify.warning=function(args){return this(args,"warning")},notify.clearAll=function(){angular.forEach(messageElements,function(element){element.addClass("killed")})},notify}]}),angular.module("ui-notification").run(["$templateCache",function($templateCache){$templateCache.put("angular-ui-notification.html",'<div class="ui-notification"><h3 ng-show="title" ng-bind-html="title"></h3><div class="message" ng-bind-html="message"></div></div>')}]);